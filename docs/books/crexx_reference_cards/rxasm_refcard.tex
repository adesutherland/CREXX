\documentclass[10pt]{article}
\usepackage{supertabular}
\usepackage{ascii}
\usepackage[orthodox,l2tabu,abort]{nag}
\usepackage{xcolor}
\definecolor{nrblue}{RGB}{38,139,210}
\definecolor{nrgreen}{RGB}{65,133,153}
\definecolor{nrcyan}{RGB}{42,161,152 }
\definecolor{nrorange}{RGB}{203 ,75,22}
\definecolor{nrgrey}{RGB}{101,123,131}

\usepackage{pagecolor}
\pagecolor{yellow!50}
\usepackage{auto-pst-pdf,pst-barcode}
% Page layout
\usepackage[landscape,margin=0.5in]{geometry}
\usepackage{multicol}
 \setlength{\columnsep}{20pt}
% Title area
\usepackage{titling} % Allows for use of date, author, etc. after \maketitle
% Ref: http://tex.stackexchange.com/questions/3988/titlesec-versus-titling-mangling-thetitle
\let\oldtitle\title
\renewcommand{\title}[1]{\oldtitle{#1}\newcommand{\mythetitle}{#1}}
\renewcommand{\maketitle}{%
{\begin{center}\Large \mythetitle\end{center}}
}
% fonts
\usepackage{fontspec}

\setmainfont[Mapping=tex-text]{TeX Gyre Termes}
\setmonofont[Mapping=tex-text,Scale=0.80]{Source Code Pro}

\newcommand{\cRexx}{cR\textsc{exx}}
\newcommand{\Rexx}{R\textsc{exx}}
\newcommand{\RxAsm}{R\textsc{xAsm}}

\usepackage{color}
\usepackage{xcolor}
\usepackage{listings}
\input{rxasformat}

%for leader dots in the TOC
\usepackage{tocloft}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}

% Document divisions
\usepackage{titlesec}
\setcounter{secnumdepth}{0}
\titlespacing{\section}{0pt}{0pt}{0pt}
\titlespacing{\subsection}{0pt}{0pt}{0pt}
\usepackage{nopageno} % To keep \section from resetting page style

\setlength{\parindent}{0pt} % disabling indentation by default

% Lists
\usepackage{enumitem} % for consistent formatting of lists
\newlist{ttdesc}{description}{1}
\setlist[ttdesc]{font=\ttfamily,noitemsep}
\usepackage{calc} % for \widthof

% Code
\usepackage{listings}
\lstset{language=[LaTeX]TeX,%
  basicstyle=\itshape,%
  keywordstyle=\normalfont\ttfamily,%
  morekeywords={part,chapter,subsection,subsubsection,paragraph,subparagraph}%
  }

 %this formats the description headings
\renewcommand{\descriptionlabel}[1]{\hspace{\labelsep}\texttt{#1}}

\title{\fontspec{Helvetica}\textbf{RXASM Reference Summary}}
\author{The \cRexx{} project}
\date{2021}


% ----------------------------
% to make supertabular work in multicolumn)
\newcount\n
\n=0
\def\tablebody{}
\makeatletter
\loop\ifnum\n<100
        \advance\n by1
        \protected@edef\tablebody{\tablebody
                \textbf{\number\n.}& shortText
                \tabularnewline
        }
\repeat

\makeatletter
\let\mcnewpage=\newpage
\newcommand{\TrickSupertabularIntoMulticols}{%
  \renewcommand\newpage{%
    \if@firstcolumn
      \hrule width\linewidth height0pt
      \columnbreak
    \else
      \mcnewpage
    \fi
  }%
}
\makeatother
%------------------------------


\begin{document}
\begin{multicols}{3}
  \TrickSupertabularIntoMulticols
  \lstset{language=rxas}
  \lstset{basicstyle=\ttfamily}
\hspace*{4cm}  \maketitle


  \vspace*{3cm}
\hspace*{-1.5cm}\rule{9.95cm}{1cm}




  
\hrulefill 

\textbf{First Edition (July 2021) - for cREXX-Phase-0 v0.1.6}


\tableofcontents
\hrulefill

\RxAsm{} assembly language is generated by the \emph{rxc} \cRexx{} translator from
\Rexx{} source and produces binary .rxbin files, when
assembled using the \emph{rxas} assembler. It can be used to write
programs to be interpreted by the \emph{rxvm} virtual machine. This
reference summary contains the machine and assembler language statements and a
short introduction to the use of the \cRexx{} commandline language tools.

\section{\fontspec{Helvetica} Machine Instructions}
These are instructions for the \emph{rxvm} virtual machine, which is 
implemented on various operating environments.

\raggedright
\begin{ttdesc}[labelwidth=\widthof{\ttfamily{letterpaper/a4paper}}]
\input{instr}
\end{ttdesc}
\section{\fontspec{Helvetica} Commandline Tools}
\raggedright
\begin{ttdesc}[labelwidth=\widthof{\ttfamily{letterpaper/a4paper}}]
\item[rxc]  translate a .rexx source file to a .rxasm source file
\item[rxas]  compile a .rxasm source file to an .rxbin binary file
\item[rxvm] run a .rxbin binary in the threaded interpreter (highest performance)
\item[rxbvm] run a .rxbin binary in the conventional interpreter (for
  VM/370)
\item[rxdas] disassemble a .rxbin binary to an .rxasm source file
\end{ttdesc}
To run a program consisting of multiple dependent functions, run
\emph{rxvm} with the first qualifiers of all required .rxbin files;
these will be automatically resolved.

\section{\fontspec{Helvetica} Assembler Instructions}
Each line has an optional \emph{label}, an instruction (machine or
assembler) and a number of operands (0 or more) of different types
(see next paragraph).

\begin{ttdesc}[labelwidth=\widthof{\ttfamily{letterpaper/a4paper}}]
\item[*]  comment until end of line
\item[.globals=\emph{n}] specifies the number of globals in this
  source file
\item[.expose] expose (make globally known) the preceding label
\item[.locals]  specifies the number of locals in this source file or
  function
\end{ttdesc}


\section{\fontspec{Helvetica} Operand Types}
\begin{ttdesc}[labelwidth=\widthof{\ttfamily{letterpaper/a4paper}}]
\item[REG] a register
\item[STRING] a sequence of Unicode characters
\item[FUNC] a global or local function
\item[ID] a label
\item[INT] an integer type (a whole number)
\item[FLOAT] a floating point number
\end{ttdesc}



\section{\fontspec{Helvetica} Calling functions}
\section{\fontspec{Helvetica} Limits}
\pagebreak
\section{\fontspec{Helvetica} Instructions by Opcode}
\begin{supertabular}{|lll|}
  \tabletail{\emph{cont. ...}}
  \tablelasttail{\emph{end}}
  \texttt{Opcode} & \texttt{Instruction} & \texttt{parameters} \\
  % \shrinkheight{2cm}
\input{opcodes}
\end{supertabular}

\section{\fontspec{Helvetica} Example Programs}
\lstinputlisting[]{main.rxas}
\lstinputlisting[]{func1.rxas}
\lstinputlisting[]{func2.rxas}
\pagebreak


\hrulefill

\noindent Copyright \textcopyright{} \thedate{} \theauthor{}
\begin{pspicture}(1in,1in)
    \psbarcode{https://github.com/adesutherland/CREXX/wiki/Logical-REXX-VM-Assembler}{eclevel=L}{qrcode}
\end{pspicture}

\end{multicols}
\end{document}
